language: python
install: make
script:
- make ci
cache: pip
jobs:
  include:
  - stage: test
    python: '3.6'
  - stage: test
    python: '3.7'
    dist: xenial
  - stage: coverage
    python: '3.6'
    script: coverage
  #- stage: build # This stage builds and lints in parallel
    #if: (branch = master)
    #name: Build
    #script: cd docs && make html && cd ../ # build the docs
  - stage: deploy
    #name: Deploy to GitHub Pages
    #if: (NOT type IN (pull_request)) AND (branch = master) # only deploy if merging on master
    before_deploy: cd docs && make html && cd ../
    deploy:
      - provider: pages # deploy on github pages
        skip_cleanup: true
        github_token:
          secure: nQrHvpvJO4nrO49Cv2AiRFdmpldJr3VBKG+ZvkntH5+BTZUu3Jf9YRvNZhOEzA8+DJqdmA1ZvHSTVe8ABtpIfZjdzfMdfQjVC3y4Ky6pSozDTxaXaXPCM206RmBiwqzdWli++UOBm+nwDPKmfGxtQZnDgQ5MjxKfPUq9ItnwAV2mJ7SuLTAKzqxOE3lnDFeznFq09mD6fok4CW7iicSENH1HaJ6n535F6eIzhzwtyIIHuMvsVGK1A69vxUx6EEyX/La//3QCKKKqGCFg2N23Lar9hxaBTPFBTislODA7kRmIHJVdWyGiB2W4vUs0QUpWmIxRwWHG4qVpj1N23q6utT8o98GfnwVR1wCfdpmWmNbRTniaKTS30/OZcbO/W4LupR0cKPD5dClP/FaRWpTToTA8Yd8SFAjpkDzl+9I7m2xB7oGqPgG7O5Mb4UXNXBbmBAY6MIDh7iIcpm0DRJIl6QeMqOrHm0cSUTGOqVGOmsdFBr3aG9lvrktzU8WhStPHIW7RkHu+i4Wdk6Olv5KNLf0+Dhsh6w6Vd99o3DY2oBs2wBJTDXF8HLWKvAH6R+jT8mmFQa21Z5ckuGFcRlTRhmIMyoqd9kYF+jeDRR42w7TmWzumSVb/F4cq9xwbC58ujkSYw6BCpgsHPNODxZdBMXuC7uOqdof2mQACNhO2+og=
        local_dir: docs/build/html
        on:
          branch: master
      - provider: pypi
        user: __token__
        password:
          secure: CBprpI5MpbgeReYOKTP8Ke/J+dC+eoDd5WEY5Tj/BpJ9v6mDIYHBhv4b5WudzaEcytEoBdEhSGM/elalJStHtPvIz8i2Di5zAnjQAo3uX3/R9uV50MdbiDIobpM617zmh2eYYwkBmVUZxm5ENzXoMUwAOFl0abEu+z+mYz3cd+zO1dm/T047mbyUn1hxwUflMejRp4oVoamtnRRd8v9E7QWh3scqIrsSYQnxMUvKr3AabkjxFwfN4PNcRNCWsqviU3jNEqwWUOGc7fMNAJBdFsr7ENm4/a432NN+ocRqq0OMpzOL7LBC9ZsEGPTCtLZPVfJ11Yo9zAMAgh+DFRxkp3jgToAjHehFs0j0XIqnux0l3ezQl2GqXosdLfdsTCcKtEW2hoH+2dpkc1p41xe6s208E/pwD1FZfPPmlDvXiSc0rB6MNgMEGq6Vf3cQFay1tfMHxydYT/hlGKg3eUx13+V0H8l8eSFxMTLYa+5btg8hUvbdEU6ET5MUxzY7hCVl3fHMacdsC+oz53ddBv+h+DlCS8wPeiFG7sWRzBWEizk/EJgLwkFIigqHq1RYZsq4GlXFdsrqgeIITcxbXARtnXz3UJONhdMqeBpfxc84maB46HKE2bohQvHbm+n2u2N05vMUMuFyOG6M7DLeLWlbpKGhMDMgPeRhBYT89E9QR88=
        on:
          tags: true
        skip_existing: true
